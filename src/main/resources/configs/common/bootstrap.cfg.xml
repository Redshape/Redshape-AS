<?xml version="1.0"?>

<config>
    <mode>PRODUCTION</mode>
    <logging>true</logging>
    <paths>
        <logs>logs</logs>
        <plugins>vendors</plugins>
        <locales>i18n</locales>
        <security>${project.build.directory}/security</security>
        <libraries>${project.build.directory}/libs:${project.build.directory}</libraries>
    </paths>
    <servers>
        <sharedSettings>
            <reconnect>true</reconnect>
            <reconnectTimes>10</reconnectTimes>
            <reconnectDelay>30</reconnectDelay>

            <ssl>
                <port>55234</port>
                <host>0.0.0.0</host>
                <enabled>true</enabled>
                <storeKey>cambalanet</storeKey>
                <storeFile>certificates.jks</storeFile>
                <reconnectTimes>10</reconnectTimes>
                <reconnectDelay>30</reconnectDelay>
            </ssl>

            <security>
                <protocols>
                    <VanillaProtocol>
                        <isAnonymousRequestsAllowed>false</isAnonymousRequestsAllowed>
                    </VanillaProtocol>
                    <HttpProtocol>
                        <isAnonymousRequestsAllowed>true</isAnonymousRequestsAllowed>
                    </HttpProtocol>
                </protocols>
            </security>

            <sessions>
                <lifetime>900</lifetime>
                <allowPersistentSessions>true</allowPersistentSessions>
            </sessions>
        </sharedSettings>
        <rmi>
            <class>com.redshape.server.RMIServer</class>
            <status>on</status>
            <host>localhost</host>
            <port>55239</port>
            <services>
                <service>
                    <class>com.redshape.remoting.interfaces.impl.EchoInterfaceImpl</class>
                    <id>EchoService</id>
                </service>
            </services>
            <properties>
                <INTERFACES_PACKAGE>com.redshape.remoting.interfaces.impl</INTERFACES_PACKAGE>
            </properties>
        </rmi>
        <api>
            <class>com.redshape.server.ApplicationServer</class>
            <status>on</status>
            <host>0.0.0.0</host>
            <port>55234</port>
            <policies>
                <policy>
                    <policyClass>com.redshape.api.security.AuthenticationPolicy</policyClass>
                    <policyType>ON_REQUEST</policyType>
                    <protocolClass>com.redshape.io.protocols.vanilla.IVanillaProtocol</protocolClass>
                    <protocolVersion>VERSION_1</protocolVersion>
                </policy>
            </policies>
            <ssl>
                <port>55234</port>
                <host>0.0.0.0</host>
                <enabled>true</enabled>
                <storeKey>cambalanet</storeKey>
                <storeFile>certificates.jks</storeFile>
            </ssl>

            <protocol>
                <version>VERSION_1</version>
                <providerClass>com.redshape.io.protocols.vanilla.VanillaVersionsRegistry</providerClass>
            </protocol>

            <reconnect>false</reconnect>
        </api>
        <http>
             <class>com.redshape.server.ApplicationServer</class>
             <status>on</status>
             <host>0.0.0.0</host>
             <port>81</port>

            <protocol>
                <version>HTTP/1.1</version>
                <providerClass>com.redshape.io.protocols.http.HttpVersionsRegistry</providerClass>
            </protocol>
        </http>
        <jms>
            <status>on</status>
            <adapter>com.redshape.messaging.AMQManager</adapter>
            <user>system</user>
            <password>manager</password>
            <uri>tcp://localhost:61616</uri>
        </jms>
        <smtp>
              <host>94.100.177.1</host>
              <port>25</port>
              <user>kobn1@mail.ru</user>
              <password>qwerty</password>
        </smtp>
    </servers>
    
    <database>
        <adapter>com.mysql.jdbc.Driver</adapter>
        <uri>jdbc:mysql://127.0.0.1:3306/vio</uri>
        <user>root</user>
        <password>1</password>
        <useUTF8>true</useUTF8>
        <charset>UTF-8</charset>
        <persistenceUnit>Persister</persistenceUnit>
        <migrationPolicy>DROP_CREATE</migrationPolicy>
        <fixturesPath>fixtures</fixturesPath>

        <migrations package="com.redshape.migration.actions"/>
    </database>
    
    <settings>
        <security>
            <filter-ip>false</filter-ip>
        </security>
        <auth>
            <recovery_time>7200</recovery_time>
            <max_fails>5</max_fails>
        </auth>
        <user>
            <presenceIdleLimit>300</presenceIdleLimit>
        </user>
        <commands>
            <package>com.redshape.cmd.commands.migrate</package>
            <package>com.redshape.cmd.commands</package>
        </commands>
        <defaultLocale>en</defaultLocale>
    </settings>

    <features>
        <package>com.redshape.features.example</package>
    </features>
    
    <tasks>
        <failsLimit>3</failsLimit>
        <afterFailDelay>1200</afterFailDelay>
    </tasks>
    
    <search>
        <engine>com.redshape.search.engines.LuceneEngine</engine>
        <indexPath>/tmp/search/lucene</indexPath>
        <defaultMaxResults>100</defaultMaxResults>
    </search>
    
    <plugins>
        <autoload>false</autoload>

        <includes>
            <testPlugin version='1.0'>
                <validateSignature>true</validateSignature>
            </testPlugin>
        </includes>
    </plugins>
</config>